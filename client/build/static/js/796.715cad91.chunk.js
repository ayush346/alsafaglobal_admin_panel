"use strict";(self.webpackChunkal_safa_global_client=self.webpackChunkal_safa_global_client||[]).push([[796],{796:(t,e,r)=>{r.r(e),r.d(e,{encodeIntoResult:()=>d,stegaEncodeSourceMap:()=>A,stegaEncodeSourceMap$1:()=>O});var n=r(490);const o=/_key\s*==\s*['"](.*)['"]/;function s(t){if(!Array.isArray(t))throw new Error("Path is not an array");return t.reduce((t,e,r)=>{const n=typeof e;if("number"===n)return`${t}[${e}]`;if("string"===n)return`${t}${0===r?"":"."}${e}`;if(function(t){return"string"==typeof t?o.test(t.trim()):"object"==typeof t&&"_key"in t}(e)&&e._key)return`${t}[_key=="${e._key}"]`;if(Array.isArray(e)){const[r,n]=e;return`${t}[${r}:${n}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(e)}\``)},"")}const i={"\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","'":"\\'","\\":"\\\\"},a={"\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t","\\'":"'","\\\\":"\\"};function c(t){const e=[],r=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let n;for(;null!==(n=r.exec(t));){if(void 0!==n[1]){const t=n[1].replace(/\\(\\|f|n|r|t|')/g,t=>a[t]);e.push(t);continue}if(void 0===n[2]){if(void 0!==n[3]){const t=n[3].replace(/\\(\\')/g,t=>a[t]);e.push({_key:t,_index:-1});continue}}else e.push(parseInt(n[2],10))}return e}function u(t){return t.map(t=>{if("string"==typeof t||"number"==typeof t)return t;if(""!==t._key)return{_key:t._key};if(-1!==t._index)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)})}function p(t){return t.map(t=>{if("string"==typeof t||"number"==typeof t)return t;if(-1!==t._index)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)})}function l(t,e){if(!e?.mappings)return;const r=`$${p(t).map(t=>"string"==typeof t?`['${t.replace(/[\f\n\r\t'\\]/g,t=>i[t])}']`:"number"==typeof t?`[${t}]`:""!==t._key?`[?(@._key=='${t._key.replace(/['\\]/g,t=>i[t])}')]`:`[${t._index}]`).join("")}`;if(void 0!==e.mappings[r])return{mapping:e.mappings[r],matchedPath:r,pathSuffix:""};const n=function(t){return t.map(t=>"string"==typeof t?`['${t.replace(/[\f\n\r\t'\\]/g,t=>i[t])}']`:"number"==typeof t?`[${t}]`:""!==t._key?`[?(@._key=='${t._key.replace(/['\\]/g,t=>i[t])}')]`:`[${t._index}]`)}(p(t));for(let o=n.length-1;o>=0;o--){const t=`$${n.slice(0,o).join("")}`,s=e.mappings[t];if(s){return{mapping:s,matchedPath:t,pathSuffix:r.substring(t.length)}}}}function f(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(function(t){return null!==t&&Array.isArray(t)}(t))return t.map((t,o)=>{if((0,n.u4)(t)){const n=t._key;if("string"==typeof n)return f(t,e,r.concat({_key:n,_index:o}))}return f(t,e,r.concat(o))});if((0,n.u4)(t)){if("block"===t._type||"span"===t._type){const n={...t};return"block"===t._type?n.children=f(t.children,e,r.concat("children")):"span"===t._type&&(n.text=f(t.text,e,r.concat("text"))),n}return Object.fromEntries(Object.entries(t).map(t=>{let[n,o]=t;return[n,f(o,e,r.concat(n))]}))}return e(t,r)}function d(t,e,r){return f(t,(t,n)=>{if("string"!=typeof t)return t;const o=l(n,e);if(!o)return t;const{mapping:s,matchedPath:i}=o;if("value"!==s.type||"documentValue"!==s.source.type)return t;const a=e.documents[s.source.document],u=e.paths[s.source.path],p=c(i),f=c(u).concat(n.slice(p.length));return r({sourcePath:f,sourceDocument:a,resultPath:n,value:t})})}const h=".",g=`drafts${h}`,y=`versions${h}`;function m(t){return t.startsWith(g)}function $(t){return t.startsWith(y)}function _(t){const{baseUrl:e,workspace:r="default",tool:n="default",id:o,type:i,path:a,projectId:c,dataset:p}=t;if(!e)throw new Error("baseUrl is required");if(!a)throw new Error("path is required");if(!o)throw new Error("id is required");if("/"!==e&&e.endsWith("/"))throw new Error("baseUrl must not end with a slash");const l="default"===r?void 0:r,f="default"===n?void 0:n,d=function(t){return $(t)?t.split(h).slice(2).join(h):m(t)?t.slice(g.length):t}(o),y=Array.isArray(a)?s(u(a)):a,_=new URLSearchParams({baseUrl:e,id:d,type:i,path:y});if(l&&_.set("workspace",l),f&&_.set("tool",f),c&&_.set("projectId",c),p&&_.set("dataset",p),function(t){return!m(t)&&!$(t)}(o))_.set("perspective","published");else if($(o)){const t=function(t){if(!$(t))return;const[e,r,...n]=t.split(h);return r}(o);_.set("perspective",t)}const k=["/"===e?"":e];l&&k.push(l);const b=["mode=presentation",`id=${d}`,`type=${i}`,`path=${encodeURIComponent(y)}`];return f&&b.push(`tool=${f}`),k.push("intent","edit",`${b.join(";")}?${_}`),k.join("/")}const k=t=>{let{sourcePath:e,resultPath:r,value:n}=t;if(/^\d{4}-\d{2}-\d{2}/.test(o=n)&&Date.parse(o)||function(t){try{const{protocol:e}=new URL(t,t.startsWith("/")?"https://acme.com":void 0);return w.has(e)||e.startsWith("web+")}catch{return!1}}(n))return!1;var o;const s=e.at(-1);return!("slug"===e.at(-2)&&"current"===s||"string"==typeof s&&(s.startsWith("_")||s.endsWith("Id"))||e.some(t=>"meta"===t||"metadata"===t||"openGraph"===t||"seo"===t)||v(e)||v(r)||"string"==typeof s&&b.has(s))},b=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","textTheme","unit","url","username","variant","website"]);const w=new Set(["app:","data:","discord:","file:","ftp:","ftps:","geo:","http:","https:","imap:","javascript:","magnet:","mailto:","maps:","ms-excel:","ms-powerpoint:","ms-word:","slack:","sms:","spotify:","steam:","teams:","tel:","vscode:","zoom:"]);function v(t){return t.some(t=>"string"==typeof t&&null!==t.match(/type/i))}const S=[8203,8204,8205,65279],x=S.map(t=>String.fromCharCode(t)),E=[8203,8204,8205,8290,8291,8288,65279,8289,119155,119156,119157,119158,119159,119160,119161,119162];Object.fromEntries(S.map((t,e)=>[t,e])),Object.fromEntries(E.map((t,e)=>[t,e.toString(16)]));const U=String.fromCodePoint(S[0]).repeat(4);function j(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";return!0!==r&&("auto"!==r||(n=t)&&"string"==typeof n&&Date.parse(n)||function(t){try{return new URL(t,t.startsWith("/")?"https://example.com":void 0),!0}catch{return!1}}(t))?t:`${t}${function(t){if(void 0===t)return"";const e="string"==typeof t?t:JSON.stringify(t),r=(new TextEncoder).encode(e);let n="";for(let o=0;o<r.length;o++){const t=r[o];n+=x[t>>6&3]+x[t>>4&3]+x[t>>2&3]+x[3&t]}return U+n}(e)}`;var n}[...S,...E].map(t=>`\\u{${t.toString(16)}}`).join("");const P=20;function A(t,e,r){const{filter:n,logger:s,enabled:i}=r;if(!i){const n="config.enabled must be true, don't call this function otherwise";throw s?.error?.(`[@sanity/client]: ${n}`,{result:t,resultSourceMap:e,config:r}),new TypeError(n)}if(!e)return s?.error?.("[@sanity/client]: Missing Content Source Map from response body",{result:t,resultSourceMap:e,config:r}),t;if(!r.studioUrl){const n="config.studioUrl must be defined";throw s?.error?.(`[@sanity/client]: ${n}`,{result:t,resultSourceMap:e,config:r}),new TypeError(n)}const a={encoded:[],skipped:[]},c=d(t,e,t=>{let{sourcePath:e,sourceDocument:o,resultPath:i,value:c}=t;if(!1===("function"==typeof n?n({sourcePath:e,resultPath:i,filterDefault:k,sourceDocument:o,value:c}):k({sourcePath:e,resultPath:i,value:c})))return s&&a.skipped.push({path:C(e),value:`${c.slice(0,P)}${c.length>P?"...":""}`,length:c.length}),c;s&&a.encoded.push({path:C(e),value:`${c.slice(0,P)}${c.length>P?"...":""}`,length:c.length});const{baseUrl:u,workspace:p,tool:l}=function(t){let e="string"==typeof t?t:t.baseUrl;return"/"!==e&&(e=e.replace(/\/$/,"")),"string"==typeof t?{baseUrl:e}:{...t,baseUrl:e}}("function"==typeof r.studioUrl?r.studioUrl(o):r.studioUrl);if(!u)return c;const{_id:f,_type:d,_projectId:h,_dataset:g}=o;return j(c,{origin:"sanity.io",href:_({baseUrl:u,workspace:p,tool:l,id:f,type:d,path:e,...!r.omitCrossDatasetReferenceData&&{dataset:g,projectId:h}})},!0)});if(s){const t=a.skipped.length,e=a.encoded.length;if((t||e)&&((s?.groupCollapsed||s.log)?.("[@sanity/client]: Encoding source map into result"),s.log?.(`[@sanity/client]: Paths encoded: ${a.encoded.length}, skipped: ${a.skipped.length}`)),a.encoded.length>0&&(s?.log?.("[@sanity/client]: Table of encoded paths"),(s?.table||s.log)?.(a.encoded)),a.skipped.length>0){const t=new Set;for(const{path:e}of a.skipped)t.add(e.replace(o,"0").replace(/\[\d+\]/g,"[]"));s?.log?.("[@sanity/client]: List of skipped paths",[...t.values()])}(t||e)&&s?.groupEnd?.()}return c}function C(t){return s(u(t))}var O=Object.freeze({__proto__:null,stegaEncodeSourceMap:A})}}]);
//# sourceMappingURL=796.715cad91.chunk.js.map